<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Form - CareConnect</title>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="/css/common.css" />
    <link rel="stylesheet" href="/css/form.css" />
  </head>
  <body>
    <div class="top-container">
      <header>
        <h1 class="logo">
          <span class="blue-c">C</span>are<span class="blue-c">C</span>onnect
        </h1>
      </header>
    </div>

    <div class="form-container">
      <form id="infoForm" onsubmit="submitForm(event)">
        <div class="form-group">
          <label for="home">Home</label>
          <select id="home" required>
            <option value="">Select home</option>
            <option value="Home1">Home1</option>
            <option value="Home2">Home2</option>
            <option value="Home3">Home3</option>
            <option value="Home4">Home4</option>
          </select>
        </div>

        <div class="form-group">
          <label for="department">Department</label>
          <select id="department" required>
            <option value="">Select department</option>
            <option value="Dept 1">Dept 1</option>
            <option value="Dept 2">Dept 2</option>
            <option value="Dept 3">Dept 3</option>
          </select>
        </div>

        <div class="form-group name-designation-group">
          <div class="name-field">
            <label for="name">Name</label>
            <input type="text" id="name" placeholder="Enter name" required />
          </div>
          <div class="designation-field">
            <label for="designation">Designation</label>
            <input
              type="text"
              id="designation"
              placeholder="Enter designation"
              required
            />
          </div>
        </div>

        <div class="form-group">
          <label for="information">Information</label>
          <textarea
            id="information"
            placeholder="Enter information details"
            required
          ></textarea>
        </div>

        <div class="form-group">
          <label for="authorizedBy">Authorized By</label>
          <select id="authorizedBy" required>
            <option value="">Select authorizing person</option>
            <option value="Manager 1">Manager 1</option>
            <option value="Manager 2">Manager 2</option>
            <option value="Manager 3">Manager 3</option>
          </select>
        </div>

        <div class="send-to-box">
          <label>Send To</label>
          <div class="send-to-options">
            <div class="option-chip">All</div>
            <div class="option-chip">Catering</div>
            <div class="option-chip">Outreach</div>
            <div class="option-chip">Reception</div>
            <div class="option-chip">Dementia</div>
            <div class="option-chip">Housekeeping</div>
            <div class="option-chip">Admin Office</div>
          </div>
        </div>

        <div class="button-group">
          <button
            type="button"
            class="btn btn-back"
            onclick="window.location.href='index.html'"
          >
            <i class="fas fa-arrow-left"></i> Back
          </button>
          <button type="submit" class="btn btn-send">
            <i class="fas fa-paper-plane"></i> Send
          </button>
        </div>
      </form>
    </div>

    <script>
      // Get the type from URL parameters
      const urlParams = new URLSearchParams(window.location.search);
      const type = urlParams.get("type") || "routine"; // Default to routine if no type specified

      // Add the type class to body
      document.body.classList.add(type);

      // Make chips selectable
      document.querySelectorAll(".option-chip").forEach((chip) => {
        chip.addEventListener("click", function () {
          if (this.textContent === "All") {
            // Handle 'All' chip
            const isSelected = !this.classList.contains("selected");
            document.querySelectorAll(".option-chip").forEach((c) => {
              if (isSelected) {
                c.classList.add("selected");
              } else {
                c.classList.remove("selected");
              }
            });
          } else {
            // Handle other chips
            this.classList.toggle("selected");

            // Check if all individual chips are selected
            const allChip = document.querySelector(".option-chip:first-child");
            const otherChips = document.querySelectorAll(
              ".option-chip:not(:first-child)"
            );
            const allSelected = Array.from(otherChips).every((c) =>
              c.classList.contains("selected")
            );

            if (allSelected) {
              allChip.classList.add("selected");
            } else {
              allChip.classList.remove("selected");
            }
          }
        });
      });

      // Form submission handler
      async function submitForm(event) {
        event.preventDefault();

        // Get selected departments
        const selectedDepartments = Array.from(
          document.querySelectorAll(".option-chip.selected")
        ).map((chip) => chip.textContent);

        const formData = {
          home: document.getElementById("home").value,
          department: document.getElementById("department").value,
          name: document.getElementById("name").value,
          designation: document.getElementById("designation").value,
          information: document.getElementById("information").value,
          authorizedBy: document.getElementById("authorizedBy").value,
          sendTo: selectedDepartments,
        };

        console.log("Form data:", formData);
        alert("Form submitted successfully!");
      }
    </script>
  </body>
</html>
